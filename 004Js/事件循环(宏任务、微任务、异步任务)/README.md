# 事件循环

+ 1，js中有三个任务队列：主任务队列，job queue，message queue；

+ 2，它们的优先级是：主任务队列 > job queue > message queue；

+ 3，每当要执行下一个任务前（或者一个任务完成后），js会根据优先级询问各个任务队列是否为空，一旦遇到非空任务队列时则取其第一




> 涉及 主线程，执行栈，回调函数、任务队列(消息队列)

> 异步任务不是并行任务，回调场景下，异步是为了确定执行的顺序

+ 主线程
+ JS 调用栈是一种后进先出的数据结构。
   + 当函数被调用时，会被添加到栈中的顶部，当其内部同步任务都执行完成之后外部的函数才会就从栈顶部移出该函数，直到栈内被清空

+ 单线程中的任务分为 同步任务 和 异步任务。
   + 同步任务会在调用栈中按照顺序排队等待主线程执行
   + 异步任务则会在异步有了结果后将注册的回调函数添加到任务队列(消息队列)中等待栈内被清空的时读取到栈中等待主线程执行。
   + 任务队列是先进先出的数据结构


## 浏览器常驻线程

+ 1 渲染引擎
+ 2 js引擎
+ 3 定时触发器线程
+ 4 事件触发线程
+ 5 异步http请求线程

## 具体过程
+ 0 语法检查
+ 1 扫描是同步任务，直接进入执行栈 stack(先进后出) 
+ 2 若是 宏任务微任务会 push 到 task queue 任务队列
+ 3 当执行栈清空时，才会将 任务队列 中的 异步任务(先进先出)  加进来执行
+ 4 执行宏任务时，会连带执行完里面的微任务



## 宏任务、微任务、异步任务(回调)

+ 同步任务
    + 页面骨架和页面元素的渲染过程
    + 执行栈的非宏任务微任务

+ 异步任务 
    + 加载图片等资源
    + async...await

+ 宏任务 , 含 callback

   + script
   + settimeout
   + setinternal 
   + setimmediate 
   + requestAnimationFrame ， 60Hz ， 1000ms / 60 
   + IO UI render
   + new promise()

+ 微任务队列
   + process.nextTick(node)
   + promise.resolve().then() 
   + object.observe
   + mutationObserver

 
